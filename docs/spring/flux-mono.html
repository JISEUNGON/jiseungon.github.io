<!DOCTYPE html> <html lang="en"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <link rel="stylesheet" href="/assets/css/just-the-docs-head-nav.css" id="jtd-head-nav-stylesheet"> <style id="jtd-nav-activation"> .site-nav > ul.nav-list:first-child > li > a, .site-nav > ul.nav-list:first-child > li > ul > li:not(:nth-child(4)) > a, .site-nav > ul.nav-list:first-child > li > ul > li > ul > li a { background-image: none; } .site-nav > ul.nav-list:not(:first-child) a, .site-nav li.external a { background-image: none; } .site-nav > ul.nav-list:first-child > li:nth-child(1) > ul > li:nth-child(4) > a { font-weight: 600; text-decoration: none; }.site-nav > ul.nav-list:first-child > li:nth-child(1) > button svg, .site-nav > ul.nav-list:first-child > li:nth-child(1) > ul > li:nth-child(4) > button svg { transform: rotate(-90deg); }.site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(1) > ul.nav-list, .site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(1) > ul.nav-list > li.nav-list-item:nth-child(4) > ul.nav-list { display: block; } </style> <script src="/assets/js/vendor/lunr.min.js"></script> <script src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>Flux와 Mono 이해하기 | Seungeon’s blog</title> <meta name="generator" content="Jekyll v3.10.0" /> <meta property="og:title" content="Flux와 Mono 이해하기" /> <meta property="og:locale" content="en" /> <meta property="og:site_name" content="Seungeon’s blog" /> <meta property="og:type" content="article" /> <meta property="article:published_time" content="2025-08-03T00:00:00+09:00" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Flux와 Mono 이해하기" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2025-08-03T00:00:00+09:00","datePublished":"2025-08-03T00:00:00+09:00","headline":"Flux와 Mono 이해하기","mainEntityOfPage":{"@type":"WebPage","@id":"/docs/spring/flux-mono.html"},"url":"/docs/spring/flux-mono.html"}</script> <!-- End Jekyll SEO tag --> </head> <body> <a class="skip-to-main" href="#main-content">Skip to main content</a> <svg xmlns="http://www.w3.org/2000/svg" class="d-none"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <!-- Feather. MIT License: https://github.com/feathericons/feather/blob/master/LICENSE --> <symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"> <title id="svg-external-link-title">(external link)</title> <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <!-- Bootstrap Icons. MIT License: https://github.com/twbs/icons/blob/main/LICENSE.md --> <symbol id="svg-copy" viewBox="0 0 16 16"> <title>Copy</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16"> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/> <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/> </svg> </symbol> <symbol id="svg-copied" viewBox="0 0 16 16"> <title>Copied</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16"> <path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"/> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"/> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header" role="banner"> <a href="/" class="site-title lh-tight"> Seungeon's blog </a> <button id="menu-button" class="site-button btn-reset" aria-label="Toggle menu" aria-pressed="false"> <svg viewBox="0 0 24 24" class="icon" aria-hidden="true"><use xlink:href="#svg-menu"></use></svg> </button> </div> <nav aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Spring category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/spring/" class="nav-list-link">Spring</a><ul class="nav-list"><li class="nav-list-item"><a href="/docs/spring/api-gateway-webflux.html" class="nav-list-link">Spring boot gateway</a></li><li class="nav-list-item"><a href="/docs/spring/overview.html" class="nav-list-link">Spring WebFlux Overview</a></li><li class="nav-list-item"><a href="/docs/spring/webflux.html" class="nav-list-link">Spring WebFlux</a></li><li class="nav-list-item"><a href="/docs/spring/flux-mono.html" class="nav-list-link">Flux와 Mono 이해하기</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Kubernetes category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/k8s/" class="nav-list-link">Kubernetes</a><ul class="nav-list"><li class="nav-list-item"><a href="/docs/k8s/command.html" class="nav-list-link">How to use kubectl</a></li><li class="nav-list-item"><a href="/docs/k8s/concept.html" class="nav-list-link">What-is-Kubernetes</a></li><li class="nav-list-item"><a href="/docs/k8s/grammer.html" class="nav-list-link">How-to-write-helm-chart</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Kubernetes Components category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/k8s/componentes/" class="nav-list-link">Kubernetes Components</a><ul class="nav-list"><li class="nav-list-item"><a href="/docs/k8s/componentes/clusterrole.html" class="nav-list-link">ClusterRole</a></li><li class="nav-list-item"><a href="/docs/k8s/componentes/pod.html" class="nav-list-link">Pod</a></li><li class="nav-list-item"><a href="/docs/k8s/componentes/deployment.html" class="nav-list-link">Deployment</a></li><li class="nav-list-item"><a href="/docs/k8s/componentes/service.html" class="nav-list-link">Service</a></li><li class="nav-list-item"><a href="/docs/k8s/componentes/ingress.html" class="nav-list-link">Ingress</a></li><li class="nav-list-item"><a href="/docs/k8s/componentes/configmap.html" class="nav-list-link">ConfigMap</a></li><li class="nav-list-item"><a href="/docs/k8s/componentes/role.html" class="nav-list-link">Role</a></li><li class="nav-list-item"><a href="/docs/k8s/componentes/rolebinding.html" class="nav-list-link">RoleBinding</a></li><li class="nav-list-item"><a href="/docs/k8s/componentes/clusterrolebinding.html" class="nav-list-link">ClusterRoleBinding</a></li><li class="nav-list-item"><a href="/docs/k8s/componentes/serviceaccount.html" class="nav-list-link">ServiceAccount</a></li><li class="nav-list-item"><a href="/docs/k8s/componentes/statefulset.html" class="nav-list-link">StatefulSet</a></li><li class="nav-list-item"><a href="/docs/k8s/componentes/kube-system.html" class="nav-list-link">kube-system</a></li></ul></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Markdown category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/diagram/" class="nav-list-link">Markdown</a><ul class="nav-list"><li class="nav-list-item"><a href="/docs/markdown/diagram.html" class="nav-list-link">How to make diagram in markdown</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Helm category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/helm/" class="nav-list-link">Helm</a><ul class="nav-list"><li class="nav-list-item"><a href="/docs/helm/command.html" class="nav-list-link">How-to-use-Helm</a></li><li class="nav-list-item"><a href="/docs/helm/concept.html" class="nav-list-link">What-is-Helm</a></li><li class="nav-list-item"><a href="/docs/helm/grammer.html" class="nav-list-link">How-to-write-helm-chart</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Git category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/git/" class="nav-list-link">Git</a><ul class="nav-list"><li class="nav-list-item"><a href="/docs/git/command.html" class="nav-list-link">git-command</a></li><li class="nav-list-item"><a href="/docs/git/git-concepts.html" class="nav-list-link">Git 개념</a></li><li class="nav-list-item"><a href="/docs/git/git-filter-repo.html" class="nav-list-link">git-filter-repo</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Deploy category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/deploy/" class="nav-list-link">Deploy</a><ul class="nav-list"><li class="nav-list-item"><a href="/docs/deploy/rolling-update.html" class="nav-list-link">Rolling Update</a></li><li class="nav-list-item"><a href="/docs/deploy/blue-green.html" class="nav-list-link">Blue/Green Deployment</a></li><li class="nav-list-item"><a href="/docs/deploy/canary.html" class="nav-list-link">Canary Deployment</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Jekyll category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/jekyll/" class="nav-list-link">Jekyll</a><ul class="nav-list"><li class="nav-list-item"><a href="/docs/jekyll/install-jekyll.html" class="nav-list-link">How to Install Jekyll</a></li><li class="nav-list-item"><a href="/docs/jekyll/just-the-docs.html" class="nav-list-link">How to use just-the-docs docs</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Container category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/all-container/" class="nav-list-link">Container</a><ul class="nav-list"><li class="nav-list-item"><a href="/docs/all-container/container-runtime.html" class="nav-list-link">What-is-Container-Runtime</a></li><li class="nav-list-item"><a href="/docs/all-container/container.html" class="nav-list-link">What-is-Container</a></li><li class="nav-list-item"><a href="/docs/all-container/docker.html" class="nav-list-link">All-of-docker</a></li><li class="nav-list-item"><a href="/docs/all-container/registry.html" class="nav-list-link">Docker Registry</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Network category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/network/" class="nav-list-link">Network</a><ul class="nav-list"><li class="nav-list-item"><a href="/docs/network/3way-handshake.html" class="nav-list-link">3-Way Handshake</a></li><li class="nav-list-item"><a href="/docs/network/tcp-udp.html" class="nav-list-link">TCP vs UDP</a></li></ul></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search" role="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Seungeon's blog" aria-label="Search Seungeon's blog" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> </div> <div class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="/spring/">Spring</a></li> <li class="breadcrumb-nav-list-item"><span>Flux와 Mono 이해하기</span></li> </ol> </nav> <div id="main-content" class="main-content"> <main> <h1 id="flux와-mono-이해하기"> <a href="#flux와-mono-이해하기" class="anchor-heading" aria-labelledby="flux와-mono-이해하기"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Flux와 Mono 이해하기 </h1> <h2 id="개요"> <a href="#개요" class="anchor-heading" aria-labelledby="개요"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 개요 </h2> <p>Flux와 Mono는 Spring WebFlux의 핵심인 Reactor 라이브러리에서 제공하는 리액티브 스트림 타입입니다. 이들은 Reactive Streams 스펙을 구현하며, 비동기 데이터 스트림을 처리하는 데 사용됩니다.</p> <h2 id="reactive-streams-기반"> <a href="#reactive-streams-기반" class="anchor-heading" aria-labelledby="reactive-streams-기반"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Reactive Streams 기반 </h2> <h3 id="1-reactive-streams-스펙"> <a href="#1-reactive-streams-스펙" class="anchor-heading" aria-labelledby="1-reactive-streams-스펙"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 1. Reactive Streams 스펙 </h3><pre><code class="language-mermaid">graph LR
    Publisher[Publisher&lt;br/&gt;데이터 발행자] --&gt; Subscription[Subscription&lt;br/&gt;구독 관계]
    Subscription --&gt; Subscriber[Subscriber&lt;br/&gt;데이터 구독자]

    subgraph "Reactive Streams"
        Backpressure[Backpressure&lt;br/&gt;흐름 제어]
        Error[Error Handling&lt;br/&gt;에러 처리]
        Complete[Complete&lt;br/&gt;완료 신호]
    end

    Publisher --&gt; Backpressure
    Subscriber --&gt; Error
    Subscription --&gt; Complete
</code></pre><ul> <li><strong>Publisher</strong>: 데이터를 발행하는 역할</li> <li><strong>Subscriber</strong>: 데이터를 구독하고 처리하는 역할</li> <li><strong>Subscription</strong>: Publisher와 Subscriber 간의 구독 관계</li> <li><strong>Backpressure</strong>: 데이터 흐름 제어 메커니즘</li> </ul> <h3 id="2-java-9에서의-채택"> <a href="#2-java-9에서의-채택" class="anchor-heading" aria-labelledby="2-java-9에서의-채택"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 2. Java 9에서의 채택 </h3> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Java 9의 Reactive Streams 인터페이스</span>
<span class="kn">import</span> <span class="nn">java.util.concurrent.Flow</span><span class="o">;</span>

<span class="nc">Flow</span><span class="o">.</span><span class="na">Publisher</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">publisher</span> <span class="o">=</span> <span class="o">...;</span>
<span class="nc">Flow</span><span class="o">.</span><span class="na">Subscriber</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">subscriber</span> <span class="o">=</span> <span class="o">...;</span>
<span class="nc">Flow</span><span class="o">.</span><span class="na">Subscription</span> <span class="n">subscription</span> <span class="o">=</span> <span class="o">...;</span>
</code></pre></div></div> <h2 id="mono---단일-요소-스트림"> <a href="#mono---단일-요소-스트림" class="anchor-heading" aria-labelledby="mono---단일-요소-스트림"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Mono<T> - 단일 요소 스트림</T> </h2> <h3 id="1-mono의-개념"> <a href="#1-mono의-개념" class="anchor-heading" aria-labelledby="1-mono의-개념"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 1. Mono의 개념 </h3> <p>Mono는 0개 또는 1개의 요소를 발행하는 리액티브 스트림입니다. 주로 단일 결과를 반환하는 작업에 사용됩니다.</p><pre><code class="language-mermaid">graph TB
    subgraph "Mono&lt;T&gt; - 단일 요소"
        MonoEmpty[Mono.empty()&lt;br/&gt;0개 요소 - 완료]
        MonoJust[Mono.just(item)&lt;br/&gt;1개 요소 - 성공]
        MonoError[Mono.error()&lt;br/&gt;에러 발생]
        MonoDefer[Mono.defer()&lt;br/&gt;지연 실행]
        MonoFromCallable[Mono.fromCallable()&lt;br/&gt;Callable에서 생성]
    end

    subgraph "Mono 생성 패턴"
        MonoCreate[Mono.create()&lt;br/&gt;수동 생성]
        MonoFromSupplier[Mono.fromSupplier()&lt;br/&gt;Supplier에서 생성]
        MonoFromFuture[Mono.fromFuture()&lt;br/&gt;Future에서 생성]
    end

    style MonoJust fill:#e1f5fe
    style MonoError fill:#ffebee
    style MonoDefer fill:#f3e5f5
</code></pre><h3 id="2-mono-생성-방법"> <a href="#2-mono-생성-방법" class="anchor-heading" aria-labelledby="2-mono-생성-방법"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 2. Mono 생성 방법 </h3> <h4 id="기본-생성"> <a href="#기본-생성" class="anchor-heading" aria-labelledby="기본-생성"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 기본 생성 </h4> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// 1. 단일 요소 Mono</span>
<span class="nc">Mono</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">mono1</span> <span class="o">=</span> <span class="nc">Mono</span><span class="o">.</span><span class="na">just</span><span class="o">(</span><span class="s">"Hello World"</span><span class="o">);</span>
<span class="nc">Mono</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">mono2</span> <span class="o">=</span> <span class="nc">Mono</span><span class="o">.</span><span class="na">just</span><span class="o">(</span><span class="mi">42</span><span class="o">);</span>

<span class="c1">// 2. 빈 Mono</span>
<span class="nc">Mono</span><span class="o">&lt;</span><span class="nc">Void</span><span class="o">&gt;</span> <span class="n">emptyMono</span> <span class="o">=</span> <span class="nc">Mono</span><span class="o">.</span><span class="na">empty</span><span class="o">();</span>

<span class="c1">// 3. 에러 Mono</span>
<span class="nc">Mono</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">errorMono</span> <span class="o">=</span> <span class="nc">Mono</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="k">new</span> <span class="nc">RuntimeException</span><span class="o">(</span><span class="s">"Error occurred"</span><span class="o">));</span>

<span class="c1">// 4. null 값 Mono</span>
<span class="nc">Mono</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">nullMono</span> <span class="o">=</span> <span class="nc">Mono</span><span class="o">.</span><span class="na">justOrEmpty</span><span class="o">(</span><span class="kc">null</span><span class="o">);</span> <span class="c1">// 빈 Mono 반환</span>
</code></pre></div></div> <h4 id="지연-실행-mono"> <a href="#지연-실행-mono" class="anchor-heading" aria-labelledby="지연-실행-mono"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 지연 실행 Mono </h4> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// 1. defer - 구독 시점에 실행</span>
<span class="nc">Mono</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">lazyMono</span> <span class="o">=</span> <span class="nc">Mono</span><span class="o">.</span><span class="na">defer</span><span class="o">(()</span> <span class="o">-&gt;</span> <span class="o">{</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Executing..."</span><span class="o">);</span>
    <span class="k">return</span> <span class="nc">Mono</span><span class="o">.</span><span class="na">just</span><span class="o">(</span><span class="s">"Lazy result"</span><span class="o">);</span>
<span class="o">});</span>

<span class="c1">// 2. fromCallable - Callable에서 생성</span>
<span class="nc">Mono</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">callableMono</span> <span class="o">=</span> <span class="nc">Mono</span><span class="o">.</span><span class="na">fromCallable</span><span class="o">(()</span> <span class="o">-&gt;</span> <span class="o">{</span>
    <span class="c1">// 복잡한 계산이나 I/O 작업</span>
    <span class="k">return</span> <span class="s">"Result from callable"</span><span class="o">;</span>
<span class="o">});</span>

<span class="c1">// 3. fromSupplier - Supplier에서 생성</span>
<span class="nc">Mono</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">supplierMono</span> <span class="o">=</span> <span class="nc">Mono</span><span class="o">.</span><span class="na">fromSupplier</span><span class="o">(()</span> <span class="o">-&gt;</span> <span class="o">{</span>
    <span class="k">return</span> <span class="s">"Result from supplier"</span><span class="o">;</span>
<span class="o">});</span>
</code></pre></div></div> <h4 id="수동-생성"> <a href="#수동-생성" class="anchor-heading" aria-labelledby="수동-생성"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 수동 생성 </h4> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Mono.create() - 수동으로 Mono 생성</span>
<span class="nc">Mono</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">manualMono</span> <span class="o">=</span> <span class="nc">Mono</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="n">sink</span> <span class="o">-&gt;</span> <span class="o">{</span>
    <span class="c1">// 비동기 작업 수행</span>
    <span class="nc">CompletableFuture</span><span class="o">.</span><span class="na">runAsync</span><span class="o">(()</span> <span class="o">-&gt;</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="nc">Thread</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="mi">1000</span><span class="o">);</span>
            <span class="n">sink</span><span class="o">.</span><span class="na">success</span><span class="o">(</span><span class="s">"Manual result"</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">InterruptedException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">sink</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">});</span>
<span class="o">});</span>

<span class="c1">// 조건부 Mono 생성</span>
<span class="nc">Mono</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">conditionalMono</span> <span class="o">=</span> <span class="nc">Mono</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="n">sink</span> <span class="o">-&gt;</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span><span class="nc">Math</span><span class="o">.</span><span class="na">random</span><span class="o">()</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">sink</span><span class="o">.</span><span class="na">success</span><span class="o">(</span><span class="s">"Success"</span><span class="o">);</span>
    <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
        <span class="n">sink</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="k">new</span> <span class="nc">RuntimeException</span><span class="o">(</span><span class="s">"Random error"</span><span class="o">));</span>
    <span class="o">}</span>
<span class="o">});</span>
</code></pre></div></div> <h3 id="3-mono-조작-메서드"> <a href="#3-mono-조작-메서드" class="anchor-heading" aria-labelledby="3-mono-조작-메서드"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 3. Mono 조작 메서드 </h3> <h4 id="변환-transform"> <a href="#변환-transform" class="anchor-heading" aria-labelledby="변환-transform"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 변환 (Transform) </h4> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// 1. map - 요소 변환</span>
<span class="nc">Mono</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">original</span> <span class="o">=</span> <span class="nc">Mono</span><span class="o">.</span><span class="na">just</span><span class="o">(</span><span class="s">"Hello"</span><span class="o">);</span>
<span class="nc">Mono</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">transformed</span> <span class="o">=</span> <span class="n">original</span><span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="n">str</span> <span class="o">-&gt;</span> <span class="n">str</span> <span class="o">+</span> <span class="s">" World"</span><span class="o">);</span>
<span class="c1">// 결과: "Hello World"</span>

<span class="c1">// 2. flatMap - Mono를 다른 Mono로 변환</span>
<span class="nc">Mono</span><span class="o">&lt;</span><span class="nc">User</span><span class="o">&gt;</span> <span class="n">userMono</span> <span class="o">=</span> <span class="nc">Mono</span><span class="o">.</span><span class="na">just</span><span class="o">(</span><span class="k">new</span> <span class="nc">User</span><span class="o">(</span><span class="s">"john"</span><span class="o">));</span>
<span class="nc">Mono</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">emailMono</span> <span class="o">=</span> <span class="n">userMono</span><span class="o">.</span><span class="na">flatMap</span><span class="o">(</span><span class="n">user</span> <span class="o">-&gt;</span>
    <span class="nc">Mono</span><span class="o">.</span><span class="na">just</span><span class="o">(</span><span class="n">user</span><span class="o">.</span><span class="na">getEmail</span><span class="o">()));</span>

<span class="c1">// 3. switchIfEmpty - 빈 Mono일 때 대체값</span>
<span class="nc">Mono</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">fallbackMono</span> <span class="o">=</span> <span class="nc">Mono</span><span class="o">.</span><span class="na">just</span><span class="o">(</span><span class="s">"Default"</span><span class="o">);</span>
<span class="nc">Mono</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">result</span> <span class="o">=</span> <span class="nc">Mono</span><span class="o">.</span><span class="na">empty</span><span class="o">().</span><span class="na">switchIfEmpty</span><span class="o">(</span><span class="n">fallbackMono</span><span class="o">);</span>
</code></pre></div></div> <h4 id="필터링-filter"> <a href="#필터링-filter" class="anchor-heading" aria-labelledby="필터링-filter"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 필터링 (Filter) </h4> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// 1. filter - 조건에 맞는 요소만 통과</span>
<span class="nc">Mono</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">numberMono</span> <span class="o">=</span> <span class="nc">Mono</span><span class="o">.</span><span class="na">just</span><span class="o">(</span><span class="mi">10</span><span class="o">);</span>
<span class="nc">Mono</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">filteredMono</span> <span class="o">=</span> <span class="n">numberMono</span><span class="o">.</span><span class="na">filter</span><span class="o">(</span><span class="n">n</span> <span class="o">-&gt;</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="o">);</span>
<span class="c1">// 결과: 10</span>

<span class="c1">// 2. filterWhen - 비동기 조건으로 필터링</span>
<span class="nc">Mono</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">asyncFiltered</span> <span class="o">=</span> <span class="nc">Mono</span><span class="o">.</span><span class="na">just</span><span class="o">(</span><span class="s">"test"</span><span class="o">)</span>
    <span class="o">.</span><span class="na">filterWhen</span><span class="o">(</span><span class="n">str</span> <span class="o">-&gt;</span> <span class="nc">Mono</span><span class="o">.</span><span class="na">just</span><span class="o">(</span><span class="n">str</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="o">));</span>
</code></pre></div></div> <h4 id="에러-처리-error-handling"> <a href="#에러-처리-error-handling" class="anchor-heading" aria-labelledby="에러-처리-error-handling"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 에러 처리 (Error Handling) </h4> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// 1. onErrorReturn - 에러 시 기본값 반환</span>
<span class="nc">Mono</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">errorHandledMono</span> <span class="o">=</span> <span class="nc">Mono</span><span class="o">.</span><span class="na">just</span><span class="o">(</span><span class="s">"test"</span><span class="o">)</span>
    <span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="n">str</span> <span class="o">-&gt;</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">str</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="s">"error"</span><span class="o">))</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">RuntimeException</span><span class="o">(</span><span class="s">"Error occurred"</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">str</span><span class="o">;</span>
    <span class="o">})</span>
    <span class="o">.</span><span class="na">onErrorReturn</span><span class="o">(</span><span class="s">"Default value"</span><span class="o">);</span>

<span class="c1">// 2. onErrorResume - 에러 시 다른 Mono로 전환</span>
<span class="nc">Mono</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">recoveredMono</span> <span class="o">=</span> <span class="nc">Mono</span><span class="o">.</span><span class="na">just</span><span class="o">(</span><span class="s">"error"</span><span class="o">)</span>
    <span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="n">str</span> <span class="o">-&gt;</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">str</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="s">"error"</span><span class="o">))</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">RuntimeException</span><span class="o">(</span><span class="s">"Error occurred"</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">str</span><span class="o">;</span>
    <span class="o">})</span>
    <span class="o">.</span><span class="na">onErrorResume</span><span class="o">(</span><span class="n">throwable</span> <span class="o">-&gt;</span> <span class="nc">Mono</span><span class="o">.</span><span class="na">just</span><span class="o">(</span><span class="s">"Recovered"</span><span class="o">));</span>

<span class="c1">// 3. onErrorMap - 에러 타입 변환</span>
<span class="nc">Mono</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">mappedError</span> <span class="o">=</span> <span class="nc">Mono</span><span class="o">.</span><span class="na">just</span><span class="o">(</span><span class="s">"test"</span><span class="o">)</span>
    <span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="n">str</span> <span class="o">-&gt;</span> <span class="o">{</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="nf">RuntimeException</span><span class="o">(</span><span class="s">"Original error"</span><span class="o">);</span>
    <span class="o">})</span>
    <span class="o">.</span><span class="na">onErrorMap</span><span class="o">(</span><span class="nc">RuntimeException</span><span class="o">.</span><span class="na">class</span><span class="o">,</span>
        <span class="n">ex</span> <span class="o">-&gt;</span> <span class="k">new</span> <span class="nc">CustomException</span><span class="o">(</span><span class="s">"Mapped error"</span><span class="o">,</span> <span class="n">ex</span><span class="o">));</span>
</code></pre></div></div> <h4 id="타임아웃-처리"> <a href="#타임아웃-처리" class="anchor-heading" aria-labelledby="타임아웃-처리"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 타임아웃 처리 </h4> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// 1. timeout - 지정 시간 내 완료되지 않으면 에러</span>
<span class="nc">Mono</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">timeoutMono</span> <span class="o">=</span> <span class="nc">Mono</span><span class="o">.</span><span class="na">just</span><span class="o">(</span><span class="s">"Slow operation"</span><span class="o">)</span>
    <span class="o">.</span><span class="na">delayElement</span><span class="o">(</span><span class="nc">Duration</span><span class="o">.</span><span class="na">ofSeconds</span><span class="o">(</span><span class="mi">5</span><span class="o">))</span>
    <span class="o">.</span><span class="na">timeout</span><span class="o">(</span><span class="nc">Duration</span><span class="o">.</span><span class="na">ofSeconds</span><span class="o">(</span><span class="mi">3</span><span class="o">))</span>
    <span class="o">.</span><span class="na">onErrorReturn</span><span class="o">(</span><span class="s">"Timeout occurred"</span><span class="o">);</span>

<span class="c1">// 2. timeout - 다른 Mono로 fallback</span>
<span class="nc">Mono</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">timeoutWithFallback</span> <span class="o">=</span> <span class="nc">Mono</span><span class="o">.</span><span class="na">just</span><span class="o">(</span><span class="s">"Slow operation"</span><span class="o">)</span>
    <span class="o">.</span><span class="na">delayElement</span><span class="o">(</span><span class="nc">Duration</span><span class="o">.</span><span class="na">ofSeconds</span><span class="o">(</span><span class="mi">5</span><span class="o">))</span>
    <span class="o">.</span><span class="na">timeout</span><span class="o">(</span><span class="nc">Duration</span><span class="o">.</span><span class="na">ofSeconds</span><span class="o">(</span><span class="mi">3</span><span class="o">),</span> <span class="nc">Mono</span><span class="o">.</span><span class="na">just</span><span class="o">(</span><span class="s">"Fallback"</span><span class="o">));</span>
</code></pre></div></div> <h3 id="4-mono-실제-사용-예제"> <a href="#4-mono-실제-사용-예제" class="anchor-heading" aria-labelledby="4-mono-실제-사용-예제"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 4. Mono 실제 사용 예제 </h3> <h4 id="컨트롤러에서의-mono-사용"> <a href="#컨트롤러에서의-mono-사용" class="anchor-heading" aria-labelledby="컨트롤러에서의-mono-사용"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 컨트롤러에서의 Mono 사용 </h4> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@RestController</span>
<span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">"/api/users"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserController</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">UserService</span> <span class="n">userService</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">UserController</span><span class="o">(</span><span class="nc">UserService</span> <span class="n">userService</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">userService</span> <span class="o">=</span> <span class="n">userService</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="c1">// 단일 사용자 조회</span>
    <span class="nd">@GetMapping</span><span class="o">(</span><span class="s">"/{id}"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">Mono</span><span class="o">&lt;</span><span class="nc">User</span><span class="o">&gt;</span> <span class="nf">getUserById</span><span class="o">(</span><span class="nd">@PathVariable</span> <span class="nc">String</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">userService</span><span class="o">.</span><span class="na">findById</span><span class="o">(</span><span class="n">id</span><span class="o">)</span>
            <span class="o">.</span><span class="na">doOnNext</span><span class="o">(</span><span class="n">user</span> <span class="o">-&gt;</span> <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"Found user: {}"</span><span class="o">,</span> <span class="n">user</span><span class="o">.</span><span class="na">getName</span><span class="o">()))</span>
            <span class="o">.</span><span class="na">doOnError</span><span class="o">(</span><span class="n">error</span> <span class="o">-&gt;</span> <span class="n">log</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="s">"Error finding user: {}"</span><span class="o">,</span> <span class="n">error</span><span class="o">.</span><span class="na">getMessage</span><span class="o">()))</span>
            <span class="o">.</span><span class="na">switchIfEmpty</span><span class="o">(</span><span class="nc">Mono</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="k">new</span> <span class="nc">UserNotFoundException</span><span class="o">(</span><span class="n">id</span><span class="o">)));</span>
    <span class="o">}</span>

    <span class="c1">// 사용자 생성</span>
    <span class="nd">@PostMapping</span>
    <span class="kd">public</span> <span class="nc">Mono</span><span class="o">&lt;</span><span class="nc">User</span><span class="o">&gt;</span> <span class="nf">createUser</span><span class="o">(</span><span class="nd">@RequestBody</span> <span class="nc">User</span> <span class="n">user</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="nc">Mono</span><span class="o">.</span><span class="na">just</span><span class="o">(</span><span class="n">user</span><span class="o">)</span>
            <span class="o">.</span><span class="na">filter</span><span class="o">(</span><span class="n">u</span> <span class="o">-&gt;</span> <span class="n">u</span><span class="o">.</span><span class="na">getEmail</span><span class="o">()</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">u</span><span class="o">.</span><span class="na">getEmail</span><span class="o">().</span><span class="na">isEmpty</span><span class="o">())</span>
            <span class="o">.</span><span class="na">flatMap</span><span class="o">(</span><span class="n">u</span> <span class="o">-&gt;</span> <span class="n">userService</span><span class="o">.</span><span class="na">save</span><span class="o">(</span><span class="n">u</span><span class="o">))</span>
            <span class="o">.</span><span class="na">doOnSuccess</span><span class="o">(</span><span class="n">savedUser</span> <span class="o">-&gt;</span> <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"User created: {}"</span><span class="o">,</span> <span class="n">savedUser</span><span class="o">.</span><span class="na">getId</span><span class="o">()))</span>
            <span class="o">.</span><span class="na">doOnError</span><span class="o">(</span><span class="n">error</span> <span class="o">-&gt;</span> <span class="n">log</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="s">"Error creating user: {}"</span><span class="o">,</span> <span class="n">error</span><span class="o">.</span><span class="na">getMessage</span><span class="o">()));</span>
    <span class="o">}</span>

    <span class="c1">// 사용자 업데이트</span>
    <span class="nd">@PutMapping</span><span class="o">(</span><span class="s">"/{id}"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">Mono</span><span class="o">&lt;</span><span class="nc">User</span><span class="o">&gt;</span> <span class="nf">updateUser</span><span class="o">(</span><span class="nd">@PathVariable</span> <span class="nc">String</span> <span class="n">id</span><span class="o">,</span> <span class="nd">@RequestBody</span> <span class="nc">User</span> <span class="n">user</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">userService</span><span class="o">.</span><span class="na">findById</span><span class="o">(</span><span class="n">id</span><span class="o">)</span>
            <span class="o">.</span><span class="na">flatMap</span><span class="o">(</span><span class="n">existingUser</span> <span class="o">-&gt;</span> <span class="o">{</span>
                <span class="n">user</span><span class="o">.</span><span class="na">setId</span><span class="o">(</span><span class="n">id</span><span class="o">);</span>
                <span class="k">return</span> <span class="n">userService</span><span class="o">.</span><span class="na">save</span><span class="o">(</span><span class="n">user</span><span class="o">);</span>
            <span class="o">})</span>
            <span class="o">.</span><span class="na">switchIfEmpty</span><span class="o">(</span><span class="nc">Mono</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="k">new</span> <span class="nc">UserNotFoundException</span><span class="o">(</span><span class="n">id</span><span class="o">)));</span>
    <span class="o">}</span>

    <span class="c1">// 사용자 삭제</span>
    <span class="nd">@DeleteMapping</span><span class="o">(</span><span class="s">"/{id}"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">Mono</span><span class="o">&lt;</span><span class="nc">Void</span><span class="o">&gt;</span> <span class="nf">deleteUser</span><span class="o">(</span><span class="nd">@PathVariable</span> <span class="nc">String</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">userService</span><span class="o">.</span><span class="na">findById</span><span class="o">(</span><span class="n">id</span><span class="o">)</span>
            <span class="o">.</span><span class="na">flatMap</span><span class="o">(</span><span class="n">user</span> <span class="o">-&gt;</span> <span class="n">userService</span><span class="o">.</span><span class="na">deleteById</span><span class="o">(</span><span class="n">id</span><span class="o">))</span>
            <span class="o">.</span><span class="na">switchIfEmpty</span><span class="o">(</span><span class="nc">Mono</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="k">new</span> <span class="nc">UserNotFoundException</span><span class="o">(</span><span class="n">id</span><span class="o">)));</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div> <h2 id="flux---다중-요소-스트림"> <a href="#flux---다중-요소-스트림" class="anchor-heading" aria-labelledby="flux---다중-요소-스트림"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Flux<T> - 다중 요소 스트림</T> </h2> <h3 id="1-flux의-개념"> <a href="#1-flux의-개념" class="anchor-heading" aria-labelledby="1-flux의-개념"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 1. Flux의 개념 </h3> <p>Flux는 0개 이상의 요소를 발행하는 리액티브 스트림입니다. 여러 데이터를 순차적으로 처리할 때 사용됩니다.</p><pre><code class="language-mermaid">graph TB
    subgraph "Flux&lt;T&gt; - 다중 요소"
        FluxEmpty[Flux.empty()&lt;br/&gt;0개 요소]
        FluxJust[Flux.just(items)&lt;br/&gt;여러 요소]
        FluxRange[Flux.range(1,10)&lt;br/&gt;범위 생성]
        FluxInterval[Flux.interval()&lt;br/&gt;주기적 생성]
        FluxGenerate[Flux.generate()&lt;br/&gt;상태 기반 생성]
    end

    subgraph "Flux 생성 패턴"
        FluxCreate[Flux.create()&lt;br/&gt;수동 생성]
        FluxFromIterable[Flux.fromIterable()&lt;br/&gt;Iterable에서 생성]
        FluxFromStream[Flux.fromStream()&lt;br/&gt;Stream에서 생성]
    end

    style FluxJust fill:#e8f5e8
    style FluxInterval fill:#fff3e0
    style FluxGenerate fill:#fce4ec
</code></pre><h3 id="2-flux-생성-방법"> <a href="#2-flux-생성-방법" class="anchor-heading" aria-labelledby="2-flux-생성-방법"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 2. Flux 생성 방법 </h3> <h4 id="기본-생성-1"> <a href="#기본-생성-1" class="anchor-heading" aria-labelledby="기본-생성-1"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 기본 생성 </h4> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// 1. 여러 요소 Flux</span>
<span class="nc">Flux</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">flux1</span> <span class="o">=</span> <span class="nc">Flux</span><span class="o">.</span><span class="na">just</span><span class="o">(</span><span class="s">"A"</span><span class="o">,</span> <span class="s">"B"</span><span class="o">,</span> <span class="s">"C"</span><span class="o">);</span>
<span class="nc">Flux</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">flux2</span> <span class="o">=</span> <span class="nc">Flux</span><span class="o">.</span><span class="na">just</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">5</span><span class="o">);</span>

<span class="c1">// 2. 범위 생성</span>
<span class="nc">Flux</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">rangeFlux</span> <span class="o">=</span> <span class="nc">Flux</span><span class="o">.</span><span class="na">range</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">10</span><span class="o">);</span> <span class="c1">// 1부터 10까지</span>

<span class="c1">// 3. 주기적 생성</span>
<span class="nc">Flux</span><span class="o">&lt;</span><span class="nc">Long</span><span class="o">&gt;</span> <span class="n">intervalFlux</span> <span class="o">=</span> <span class="nc">Flux</span><span class="o">.</span><span class="na">interval</span><span class="o">(</span><span class="nc">Duration</span><span class="o">.</span><span class="na">ofSeconds</span><span class="o">(</span><span class="mi">1</span><span class="o">));</span>

<span class="c1">// 4. 빈 Flux</span>
<span class="nc">Flux</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">emptyFlux</span> <span class="o">=</span> <span class="nc">Flux</span><span class="o">.</span><span class="na">empty</span><span class="o">();</span>
</code></pre></div></div> <h4 id="컬렉션에서-생성"> <a href="#컬렉션에서-생성" class="anchor-heading" aria-labelledby="컬렉션에서-생성"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 컬렉션에서 생성 </h4> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// 1. List에서 Flux 생성</span>
<span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span> <span class="nc">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="s">"Apple"</span><span class="o">,</span> <span class="s">"Banana"</span><span class="o">,</span> <span class="s">"Cherry"</span><span class="o">);</span>
<span class="nc">Flux</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">fluxFromList</span> <span class="o">=</span> <span class="nc">Flux</span><span class="o">.</span><span class="na">fromIterable</span><span class="o">(</span><span class="n">list</span><span class="o">);</span>

<span class="c1">// 2. Stream에서 Flux 생성</span>
<span class="nc">Flux</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">fluxFromStream</span> <span class="o">=</span> <span class="nc">Flux</span><span class="o">.</span><span class="na">fromStream</span><span class="o">(</span>
    <span class="nc">Stream</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">5</span><span class="o">)</span>
<span class="o">);</span>

<span class="c1">// 3. Array에서 Flux 생성</span>
<span class="nc">String</span><span class="o">[]</span> <span class="n">array</span> <span class="o">=</span> <span class="o">{</span><span class="s">"A"</span><span class="o">,</span> <span class="s">"B"</span><span class="o">,</span> <span class="s">"C"</span><span class="o">};</span>
<span class="nc">Flux</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">fluxFromArray</span> <span class="o">=</span> <span class="nc">Flux</span><span class="o">.</span><span class="na">fromArray</span><span class="o">(</span><span class="n">array</span><span class="o">);</span>

<span class="c1">// 4. Set에서 Flux 생성</span>
<span class="nc">Set</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">set</span> <span class="o">=</span> <span class="nc">Set</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="s">"X"</span><span class="o">,</span> <span class="s">"Y"</span><span class="o">,</span> <span class="s">"Z"</span><span class="o">);</span>
<span class="nc">Flux</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">fluxFromSet</span> <span class="o">=</span> <span class="nc">Flux</span><span class="o">.</span><span class="na">fromIterable</span><span class="o">(</span><span class="n">set</span><span class="o">);</span>
</code></pre></div></div> <h4 id="수동-생성-1"> <a href="#수동-생성-1" class="anchor-heading" aria-labelledby="수동-생성-1"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 수동 생성 </h4> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// 1. Flux.create() - 수동으로 Flux 생성</span>
<span class="nc">Flux</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">manualFlux</span> <span class="o">=</span> <span class="nc">Flux</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="n">sink</span> <span class="o">-&gt;</span> <span class="o">{</span>
    <span class="n">sink</span><span class="o">.</span><span class="na">next</span><span class="o">(</span><span class="s">"First"</span><span class="o">);</span>
    <span class="n">sink</span><span class="o">.</span><span class="na">next</span><span class="o">(</span><span class="s">"Second"</span><span class="o">);</span>
    <span class="n">sink</span><span class="o">.</span><span class="na">next</span><span class="o">(</span><span class="s">"Third"</span><span class="o">);</span>
    <span class="n">sink</span><span class="o">.</span><span class="na">complete</span><span class="o">();</span>
<span class="o">});</span>

<span class="c1">// 2. Flux.generate() - 상태 기반 생성</span>
<span class="nc">Flux</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">statefulFlux</span> <span class="o">=</span> <span class="nc">Flux</span><span class="o">.</span><span class="na">generate</span><span class="o">(</span>
    <span class="o">()</span> <span class="o">-&gt;</span> <span class="mi">0</span><span class="o">,</span> <span class="c1">// 초기 상태</span>
    <span class="o">(</span><span class="n">state</span><span class="o">,</span> <span class="n">sink</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">state</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">sink</span><span class="o">.</span><span class="na">next</span><span class="o">(</span><span class="n">state</span><span class="o">);</span>
            <span class="k">return</span> <span class="n">state</span> <span class="o">+</span> <span class="mi">1</span><span class="o">;</span>
        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
            <span class="n">sink</span><span class="o">.</span><span class="na">complete</span><span class="o">();</span>
            <span class="k">return</span> <span class="n">state</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">);</span>

<span class="c1">// 3. Flux.push() - 단일 스레드에서 생성</span>
<span class="nc">Flux</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">pushFlux</span> <span class="o">=</span> <span class="nc">Flux</span><span class="o">.</span><span class="na">push</span><span class="o">(</span><span class="n">sink</span> <span class="o">-&gt;</span> <span class="o">{</span>
    <span class="n">sink</span><span class="o">.</span><span class="na">next</span><span class="o">(</span><span class="s">"Pushed item"</span><span class="o">);</span>
    <span class="n">sink</span><span class="o">.</span><span class="na">complete</span><span class="o">();</span>
<span class="o">});</span>
</code></pre></div></div> <h4 id="조건부-생성"> <a href="#조건부-생성" class="anchor-heading" aria-labelledby="조건부-생성"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 조건부 생성 </h4> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// 1. 조건에 따른 Flux 생성</span>
<span class="nc">Flux</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">conditionalFlux</span> <span class="o">=</span> <span class="nc">Flux</span><span class="o">.</span><span class="na">defer</span><span class="o">(()</span> <span class="o">-&gt;</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span><span class="nc">Math</span><span class="o">.</span><span class="na">random</span><span class="o">()</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="nc">Flux</span><span class="o">.</span><span class="na">just</span><span class="o">(</span><span class="s">"Success"</span><span class="o">,</span> <span class="s">"Items"</span><span class="o">);</span>
    <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
        <span class="k">return</span> <span class="nc">Flux</span><span class="o">.</span><span class="na">empty</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">});</span>

<span class="c1">// 2. 에러가 있는 Flux</span>
<span class="nc">Flux</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">errorFlux</span> <span class="o">=</span> <span class="nc">Flux</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="k">new</span> <span class="nc">RuntimeException</span><span class="o">(</span><span class="s">"Flux error"</span><span class="o">));</span>
</code></pre></div></div> <h3 id="3-flux-조작-메서드"> <a href="#3-flux-조작-메서드" class="anchor-heading" aria-labelledby="3-flux-조작-메서드"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 3. Flux 조작 메서드 </h3> <h4 id="변환-transform-1"> <a href="#변환-transform-1" class="anchor-heading" aria-labelledby="변환-transform-1"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 변환 (Transform) </h4> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// 1. map - 각 요소 변환</span>
<span class="nc">Flux</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">original</span> <span class="o">=</span> <span class="nc">Flux</span><span class="o">.</span><span class="na">just</span><span class="o">(</span><span class="s">"a"</span><span class="o">,</span> <span class="s">"b"</span><span class="o">,</span> <span class="s">"c"</span><span class="o">);</span>
<span class="nc">Flux</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">transformed</span> <span class="o">=</span> <span class="n">original</span><span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="n">str</span> <span class="o">-&gt;</span> <span class="n">str</span><span class="o">.</span><span class="na">toUpperCase</span><span class="o">());</span>
<span class="c1">// 결과: "A", "B", "C"</span>

<span class="c1">// 2. flatMap - 각 요소를 Flux로 변환</span>
<span class="nc">Flux</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">words</span> <span class="o">=</span> <span class="nc">Flux</span><span class="o">.</span><span class="na">just</span><span class="o">(</span><span class="s">"hello"</span><span class="o">,</span> <span class="s">"world"</span><span class="o">);</span>
<span class="nc">Flux</span><span class="o">&lt;</span><span class="nc">Character</span><span class="o">&gt;</span> <span class="n">characters</span> <span class="o">=</span> <span class="n">words</span><span class="o">.</span><span class="na">flatMap</span><span class="o">(</span><span class="n">word</span> <span class="o">-&gt;</span>
    <span class="nc">Flux</span><span class="o">.</span><span class="na">fromArray</span><span class="o">(</span><span class="n">word</span><span class="o">.</span><span class="na">split</span><span class="o">(</span><span class="s">""</span><span class="o">))</span>
        <span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="n">str</span> <span class="o">-&gt;</span> <span class="n">str</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="mi">0</span><span class="o">)));</span>

<span class="c1">// 3. concatMap - 순서 보장하며 flatMap</span>
<span class="nc">Flux</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">ordered</span> <span class="o">=</span> <span class="n">words</span><span class="o">.</span><span class="na">concatMap</span><span class="o">(</span><span class="n">word</span> <span class="o">-&gt;</span>
    <span class="nc">Flux</span><span class="o">.</span><span class="na">fromArray</span><span class="o">(</span><span class="n">word</span><span class="o">.</span><span class="na">split</span><span class="o">(</span><span class="s">""</span><span class="o">))</span>
        <span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="n">str</span> <span class="o">-&gt;</span> <span class="n">str</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="mi">0</span><span class="o">))</span>
        <span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="n">ch</span> <span class="o">-&gt;</span> <span class="nc">String</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">ch</span><span class="o">)));</span>

<span class="c1">// 4. switchMap - 새로운 요소가 오면 이전 구독 취소</span>
<span class="nc">Flux</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">switched</span> <span class="o">=</span> <span class="nc">Flux</span><span class="o">.</span><span class="na">just</span><span class="o">(</span><span class="s">"a"</span><span class="o">,</span> <span class="s">"b"</span><span class="o">,</span> <span class="s">"c"</span><span class="o">)</span>
    <span class="o">.</span><span class="na">switchMap</span><span class="o">(</span><span class="n">item</span> <span class="o">-&gt;</span> <span class="nc">Flux</span><span class="o">.</span><span class="na">interval</span><span class="o">(</span><span class="nc">Duration</span><span class="o">.</span><span class="na">ofMillis</span><span class="o">(</span><span class="mi">100</span><span class="o">))</span>
        <span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="n">tick</span> <span class="o">-&gt;</span> <span class="n">item</span> <span class="o">+</span> <span class="s">"-"</span> <span class="o">+</span> <span class="n">tick</span><span class="o">));</span>
</code></pre></div></div> <h4 id="필터링-filter-1"> <a href="#필터링-filter-1" class="anchor-heading" aria-labelledby="필터링-filter-1"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 필터링 (Filter) </h4> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// 1. filter - 조건에 맞는 요소만 통과</span>
<span class="nc">Flux</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">numbers</span> <span class="o">=</span> <span class="nc">Flux</span><span class="o">.</span><span class="na">range</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">10</span><span class="o">);</span>
<span class="nc">Flux</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">evenNumbers</span> <span class="o">=</span> <span class="n">numbers</span><span class="o">.</span><span class="na">filter</span><span class="o">(</span><span class="n">n</span> <span class="o">-&gt;</span> <span class="n">n</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="o">);</span>
<span class="c1">// 결과: 2, 4, 6, 8, 10</span>

<span class="c1">// 2. take - 처음 N개 요소만</span>
<span class="nc">Flux</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">firstFive</span> <span class="o">=</span> <span class="n">numbers</span><span class="o">.</span><span class="na">take</span><span class="o">(</span><span class="mi">5</span><span class="o">);</span>
<span class="c1">// 결과: 1, 2, 3, 4, 5</span>

<span class="c1">// 3. skip - 처음 N개 요소 건너뛰기</span>
<span class="nc">Flux</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">skipFirstFive</span> <span class="o">=</span> <span class="n">numbers</span><span class="o">.</span><span class="na">skip</span><span class="o">(</span><span class="mi">5</span><span class="o">);</span>
<span class="c1">// 결과: 6, 7, 8, 9, 10</span>

<span class="c1">// 4. distinct - 중복 제거</span>
<span class="nc">Flux</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">duplicates</span> <span class="o">=</span> <span class="nc">Flux</span><span class="o">.</span><span class="na">just</span><span class="o">(</span><span class="s">"a"</span><span class="o">,</span> <span class="s">"b"</span><span class="o">,</span> <span class="s">"a"</span><span class="o">,</span> <span class="s">"c"</span><span class="o">,</span> <span class="s">"b"</span><span class="o">);</span>
<span class="nc">Flux</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">distinct</span> <span class="o">=</span> <span class="n">duplicates</span><span class="o">.</span><span class="na">distinct</span><span class="o">();</span>
<span class="c1">// 결과: "a", "b", "c"</span>
</code></pre></div></div> <h4 id="결합-combine"> <a href="#결합-combine" class="anchor-heading" aria-labelledby="결합-combine"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 결합 (Combine) </h4> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// 1. merge - 여러 Flux를 하나로 합치기</span>
<span class="nc">Flux</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">flux1</span> <span class="o">=</span> <span class="nc">Flux</span><span class="o">.</span><span class="na">just</span><span class="o">(</span><span class="s">"A"</span><span class="o">,</span> <span class="s">"B"</span><span class="o">);</span>
<span class="nc">Flux</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">flux2</span> <span class="o">=</span> <span class="nc">Flux</span><span class="o">.</span><span class="na">just</span><span class="o">(</span><span class="s">"C"</span><span class="o">,</span> <span class="s">"D"</span><span class="o">);</span>
<span class="nc">Flux</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">merged</span> <span class="o">=</span> <span class="nc">Flux</span><span class="o">.</span><span class="na">merge</span><span class="o">(</span><span class="n">flux1</span><span class="o">,</span> <span class="n">flux2</span><span class="o">);</span>
<span class="c1">// 결과: "A", "B", "C", "D" (순서 보장 안됨)</span>

<span class="c1">// 2. concat - 순서 보장하며 합치기</span>
<span class="nc">Flux</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">concatenated</span> <span class="o">=</span> <span class="nc">Flux</span><span class="o">.</span><span class="na">concat</span><span class="o">(</span><span class="n">flux1</span><span class="o">,</span> <span class="n">flux2</span><span class="o">);</span>
<span class="c1">// 결과: "A", "B", "C", "D" (순서 보장)</span>

<span class="c1">// 3. zip - 여러 Flux를 짝을 맞춰 결합</span>
<span class="nc">Flux</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">names</span> <span class="o">=</span> <span class="nc">Flux</span><span class="o">.</span><span class="na">just</span><span class="o">(</span><span class="s">"John"</span><span class="o">,</span> <span class="s">"Jane"</span><span class="o">);</span>
<span class="nc">Flux</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">ages</span> <span class="o">=</span> <span class="nc">Flux</span><span class="o">.</span><span class="na">just</span><span class="o">(</span><span class="mi">25</span><span class="o">,</span> <span class="mi">30</span><span class="o">);</span>
<span class="nc">Flux</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">zipped</span> <span class="o">=</span> <span class="nc">Flux</span><span class="o">.</span><span class="na">zip</span><span class="o">(</span><span class="n">names</span><span class="o">,</span> <span class="n">ages</span><span class="o">)</span>
    <span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="n">tuple</span> <span class="o">-&gt;</span> <span class="n">tuple</span><span class="o">.</span><span class="na">getT1</span><span class="o">()</span> <span class="o">+</span> <span class="s">" is "</span> <span class="o">+</span> <span class="n">tuple</span><span class="o">.</span><span class="na">getT2</span><span class="o">()</span> <span class="o">+</span> <span class="s">" years old"</span><span class="o">);</span>
<span class="c1">// 결과: "John is 25 years old", "Jane is 30 years old"</span>
</code></pre></div></div> <h4 id="수집-collect"> <a href="#수집-collect" class="anchor-heading" aria-labelledby="수집-collect"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 수집 (Collect) </h4> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// 1. collectList - 모든 요소를 List로 수집</span>
<span class="nc">Flux</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">numbers</span> <span class="o">=</span> <span class="nc">Flux</span><span class="o">.</span><span class="na">range</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">5</span><span class="o">);</span>
<span class="nc">Mono</span><span class="o">&lt;</span><span class="nc">List</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;&gt;</span> <span class="n">listMono</span> <span class="o">=</span> <span class="n">numbers</span><span class="o">.</span><span class="na">collectList</span><span class="o">();</span>
<span class="c1">// 결과: Mono&lt;List&lt;Integer&gt;&gt; with [1, 2, 3, 4, 5]</span>

<span class="c1">// 2. collectMap - 키-값 쌍으로 수집</span>
<span class="nc">Flux</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">items</span> <span class="o">=</span> <span class="nc">Flux</span><span class="o">.</span><span class="na">just</span><span class="o">(</span><span class="s">"apple"</span><span class="o">,</span> <span class="s">"banana"</span><span class="o">,</span> <span class="s">"apple"</span><span class="o">);</span>
<span class="nc">Mono</span><span class="o">&lt;</span><span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Long</span><span class="o">&gt;&gt;</span> <span class="n">countMap</span> <span class="o">=</span> <span class="n">items</span>
    <span class="o">.</span><span class="na">collectMultimap</span><span class="o">(</span><span class="n">item</span> <span class="o">-&gt;</span> <span class="n">item</span><span class="o">,</span> <span class="n">item</span> <span class="o">-&gt;</span> <span class="mi">1L</span><span class="o">)</span>
    <span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="n">map</span> <span class="o">-&gt;</span> <span class="n">map</span><span class="o">.</span><span class="na">entrySet</span><span class="o">().</span><span class="na">stream</span><span class="o">()</span>
        <span class="o">.</span><span class="na">collect</span><span class="o">(</span><span class="nc">Collectors</span><span class="o">.</span><span class="na">toMap</span><span class="o">(</span>
            <span class="nc">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">::</span><span class="n">getKey</span><span class="o">,</span>
            <span class="n">entry</span> <span class="o">-&gt;</span> <span class="o">(</span><span class="kt">long</span><span class="o">)</span> <span class="n">entry</span><span class="o">.</span><span class="na">getValue</span><span class="o">().</span><span class="na">size</span><span class="o">()</span>
        <span class="o">)));</span>

<span class="c1">// 3. reduce - 모든 요소를 하나로 축소</span>
<span class="nc">Mono</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">sum</span> <span class="o">=</span> <span class="n">numbers</span><span class="o">.</span><span class="na">reduce</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="nl">Integer:</span><span class="o">:</span><span class="n">sum</span><span class="o">);</span>
<span class="c1">// 결과: Mono&lt;Integer&gt; with 15</span>
</code></pre></div></div> <h3 id="4-flux-실제-사용-예제"> <a href="#4-flux-실제-사용-예제" class="anchor-heading" aria-labelledby="4-flux-실제-사용-예제"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 4. Flux 실제 사용 예제 </h3> <h4 id="컨트롤러에서의-flux-사용"> <a href="#컨트롤러에서의-flux-사용" class="anchor-heading" aria-labelledby="컨트롤러에서의-flux-사용"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 컨트롤러에서의 Flux 사용 </h4> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@RestController</span>
<span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">"/api/users"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserController</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">UserService</span> <span class="n">userService</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">UserController</span><span class="o">(</span><span class="nc">UserService</span> <span class="n">userService</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">userService</span> <span class="o">=</span> <span class="n">userService</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="c1">// 모든 사용자 조회</span>
    <span class="nd">@GetMapping</span>
    <span class="kd">public</span> <span class="nc">Flux</span><span class="o">&lt;</span><span class="nc">User</span><span class="o">&gt;</span> <span class="nf">getAllUsers</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">userService</span><span class="o">.</span><span class="na">findAll</span><span class="o">()</span>
            <span class="o">.</span><span class="na">filter</span><span class="o">(</span><span class="nl">User:</span><span class="o">:</span><span class="n">isActive</span><span class="o">)</span>
            <span class="o">.</span><span class="na">doOnNext</span><span class="o">(</span><span class="n">user</span> <span class="o">-&gt;</span> <span class="n">log</span><span class="o">.</span><span class="na">debug</span><span class="o">(</span><span class="s">"Processing user: {}"</span><span class="o">,</span> <span class="n">user</span><span class="o">.</span><span class="na">getName</span><span class="o">()))</span>
            <span class="o">.</span><span class="na">doOnComplete</span><span class="o">(()</span> <span class="o">-&gt;</span> <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"All users processed"</span><span class="o">));</span>
    <span class="o">}</span>

    <span class="c1">// 사용자 검색</span>
    <span class="nd">@GetMapping</span><span class="o">(</span><span class="s">"/search"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">Flux</span><span class="o">&lt;</span><span class="nc">User</span><span class="o">&gt;</span> <span class="nf">searchUsers</span><span class="o">(</span><span class="nd">@RequestParam</span> <span class="nc">String</span> <span class="n">query</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">userService</span><span class="o">.</span><span class="na">findByEmailContaining</span><span class="o">(</span><span class="n">query</span><span class="o">)</span>
            <span class="o">.</span><span class="na">take</span><span class="o">(</span><span class="mi">10</span><span class="o">)</span> <span class="c1">// 최대 10개만 반환</span>
            <span class="o">.</span><span class="na">doOnNext</span><span class="o">(</span><span class="n">user</span> <span class="o">-&gt;</span> <span class="n">log</span><span class="o">.</span><span class="na">debug</span><span class="o">(</span><span class="s">"Found matching user: {}"</span><span class="o">,</span> <span class="n">user</span><span class="o">.</span><span class="na">getEmail</span><span class="o">()));</span>
    <span class="o">}</span>

    <span class="c1">// 사용자 스트리밍</span>
    <span class="nd">@GetMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">"/stream"</span><span class="o">,</span> <span class="n">produces</span> <span class="o">=</span> <span class="nc">MediaType</span><span class="o">.</span><span class="na">APPLICATION_NDJSON_VALUE</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">Flux</span><span class="o">&lt;</span><span class="nc">User</span><span class="o">&gt;</span> <span class="nf">streamUsers</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">userService</span><span class="o">.</span><span class="na">findAll</span><span class="o">()</span>
            <span class="o">.</span><span class="na">onBackpressureBuffer</span><span class="o">(</span><span class="mi">100</span><span class="o">)</span> <span class="c1">// 최대 100개 버퍼</span>
            <span class="o">.</span><span class="na">doOnNext</span><span class="o">(</span><span class="n">user</span> <span class="o">-&gt;</span> <span class="n">log</span><span class="o">.</span><span class="na">debug</span><span class="o">(</span><span class="s">"Streaming user: {}"</span><span class="o">,</span> <span class="n">user</span><span class="o">.</span><span class="na">getName</span><span class="o">()))</span>
            <span class="o">.</span><span class="na">doOnError</span><span class="o">(</span><span class="n">error</span> <span class="o">-&gt;</span> <span class="n">log</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="s">"Error in stream: {}"</span><span class="o">,</span> <span class="n">error</span><span class="o">.</span><span class="na">getMessage</span><span class="o">()));</span>
    <span class="o">}</span>

    <span class="c1">// Server-Sent Events</span>
    <span class="nd">@GetMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">"/events"</span><span class="o">,</span> <span class="n">produces</span> <span class="o">=</span> <span class="nc">MediaType</span><span class="o">.</span><span class="na">TEXT_EVENT_STREAM_VALUE</span><span class="o">)</span>
    <span class="kd">public</span> <span class="nc">Flux</span><span class="o">&lt;</span><span class="nc">ServerSentEvent</span><span class="o">&lt;</span><span class="nc">UserEvent</span><span class="o">&gt;&gt;</span> <span class="nf">getUserEvents</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="nc">Flux</span><span class="o">.</span><span class="na">interval</span><span class="o">(</span><span class="nc">Duration</span><span class="o">.</span><span class="na">ofSeconds</span><span class="o">(</span><span class="mi">2</span><span class="o">))</span>
            <span class="o">.</span><span class="na">flatMap</span><span class="o">(</span><span class="n">tick</span> <span class="o">-&gt;</span> <span class="n">userService</span><span class="o">.</span><span class="na">findRandomUser</span><span class="o">())</span>
            <span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="n">user</span> <span class="o">-&gt;</span> <span class="nc">ServerSentEvent</span><span class="o">.&lt;</span><span class="nc">UserEvent</span><span class="o">&gt;</span><span class="n">builder</span><span class="o">()</span>
                <span class="o">.</span><span class="na">id</span><span class="o">(</span><span class="nc">String</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="nc">System</span><span class="o">.</span><span class="na">currentTimeMillis</span><span class="o">()))</span>
                <span class="o">.</span><span class="na">event</span><span class="o">(</span><span class="s">"user-activity"</span><span class="o">)</span>
                <span class="o">.</span><span class="na">data</span><span class="o">(</span><span class="k">new</span> <span class="nc">UserEvent</span><span class="o">(</span><span class="n">user</span><span class="o">.</span><span class="na">getId</span><span class="o">(),</span> <span class="s">"User logged in"</span><span class="o">,</span> <span class="nc">Instant</span><span class="o">.</span><span class="na">now</span><span class="o">()))</span>
                <span class="o">.</span><span class="na">build</span><span class="o">())</span>
            <span class="o">.</span><span class="na">take</span><span class="o">(</span><span class="mi">10</span><span class="o">);</span> <span class="c1">// 10개 이벤트만 전송</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div> <h2 id="mono와-flux의-차이점"> <a href="#mono와-flux의-차이점" class="anchor-heading" aria-labelledby="mono와-flux의-차이점"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Mono와 Flux의 차이점 </h2> <h3 id="1-개념적-차이"> <a href="#1-개념적-차이" class="anchor-heading" aria-labelledby="1-개념적-차이"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 1. 개념적 차이 </h3> <div class="table-wrapper"><table> <thead> <tr> <th>특성</th> <th>Mono<T></T></th> <th>Flux<T></T></th> </tr> </thead> <tbody> <tr> <td><strong>요소 개수</strong></td> <td>0개 또는 1개</td> <td>0개 이상</td> </tr> <tr> <td><strong>사용 사례</strong></td> <td>단일 결과 반환</td> <td>다중 데이터 처리</td> </tr> <tr> <td><strong>완료 신호</strong></td> <td>항상 완료</td> <td>완료 또는 무한</td> </tr> <tr> <td><strong>에러 처리</strong></td> <td>단일 에러</td> <td>스트림 중단</td> </tr> <tr> <td><strong>백프레셔</strong></td> <td>단순함</td> <td>복잡함</td> </tr> </tbody> </table></div> <h3 id="2-생명주기-비교"> <a href="#2-생명주기-비교" class="anchor-heading" aria-labelledby="2-생명주기-비교"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 2. 생명주기 비교 </h3><pre><code class="language-mermaid">graph TB
    subgraph "Mono 생명주기"
        MonoStart[Mono 시작] --&gt; MonoSubscribe[구독]
        MonoSubscribe --&gt; MonoNext[요소 발행]
        MonoNext --&gt; MonoComplete[완료]
        MonoSubscribe --&gt; MonoError[에러]
        MonoError --&gt; MonoComplete
    end

    subgraph "Flux 생명주기"
        FluxStart[Flux 시작] --&gt; FluxSubscribe[구독]
        FluxSubscribe --&gt; FluxNext[요소 발행]
        FluxNext --&gt; FluxNext
        FluxNext --&gt; FluxComplete[완료]
        FluxSubscribe --&gt; FluxError[에러]
        FluxError --&gt; FluxComplete
    end

    style MonoNext fill:#e1f5fe
    style FluxNext fill:#e8f5e8
    style MonoError fill:#ffebee
    style FluxError fill:#ffebee
</code></pre><h3 id="3-변환-메서드"> <a href="#3-변환-메서드" class="anchor-heading" aria-labelledby="3-변환-메서드"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 3. 변환 메서드 </h3> <h4 id="flux에서-mono로-변환"> <a href="#flux에서-mono로-변환" class="anchor-heading" aria-labelledby="flux에서-mono로-변환"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Flux에서 Mono로 변환 </h4> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Flux</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">flux</span> <span class="o">=</span> <span class="nc">Flux</span><span class="o">.</span><span class="na">just</span><span class="o">(</span><span class="s">"A"</span><span class="o">,</span> <span class="s">"B"</span><span class="o">,</span> <span class="s">"C"</span><span class="o">);</span>

<span class="c1">// 첫 번째 요소만</span>
<span class="nc">Mono</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">firstElement</span> <span class="o">=</span> <span class="n">flux</span><span class="o">.</span><span class="na">next</span><span class="o">();</span>

<span class="c1">// 모든 요소를 리스트로</span>
<span class="nc">Mono</span><span class="o">&lt;</span><span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;&gt;</span> <span class="n">allElements</span> <span class="o">=</span> <span class="n">flux</span><span class="o">.</span><span class="na">collectList</span><span class="o">();</span>

<span class="c1">// 요소 개수</span>
<span class="nc">Mono</span><span class="o">&lt;</span><span class="nc">Long</span><span class="o">&gt;</span> <span class="n">count</span> <span class="o">=</span> <span class="n">flux</span><span class="o">.</span><span class="na">count</span><span class="o">();</span>

<span class="c1">// 조건에 맞는 첫 번째 요소</span>
<span class="nc">Mono</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">firstMatch</span> <span class="o">=</span> <span class="n">flux</span><span class="o">.</span><span class="na">filter</span><span class="o">(</span><span class="n">s</span> <span class="o">-&gt;</span> <span class="n">s</span><span class="o">.</span><span class="na">startsWith</span><span class="o">(</span><span class="s">"A"</span><span class="o">)).</span><span class="na">next</span><span class="o">();</span>

<span class="c1">// 모든 요소를 하나로 축소</span>
<span class="nc">Mono</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">reduced</span> <span class="o">=</span> <span class="n">flux</span><span class="o">.</span><span class="na">reduce</span><span class="o">(</span><span class="s">""</span><span class="o">,</span> <span class="nl">String:</span><span class="o">:</span><span class="n">concat</span><span class="o">);</span>
</code></pre></div></div> <h4 id="mono에서-flux로-변환"> <a href="#mono에서-flux로-변환" class="anchor-heading" aria-labelledby="mono에서-flux로-변환"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Mono에서 Flux로 변환 </h4> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Mono</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">mono</span> <span class="o">=</span> <span class="nc">Mono</span><span class="o">.</span><span class="na">just</span><span class="o">(</span><span class="s">"Hello"</span><span class="o">);</span>

<span class="c1">// 단일 요소를 Flux로</span>
<span class="nc">Flux</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">fluxFromMono</span> <span class="o">=</span> <span class="n">mono</span><span class="o">.</span><span class="na">flux</span><span class="o">();</span>

<span class="c1">// Mono를 Flux로 확장</span>
<span class="nc">Mono</span><span class="o">&lt;</span><span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;&gt;</span> <span class="n">listMono</span> <span class="o">=</span> <span class="nc">Mono</span><span class="o">.</span><span class="na">just</span><span class="o">(</span><span class="nc">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="s">"A"</span><span class="o">,</span> <span class="s">"B"</span><span class="o">,</span> <span class="s">"C"</span><span class="o">));</span>
<span class="nc">Flux</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">expandedFlux</span> <span class="o">=</span> <span class="n">listMono</span><span class="o">.</span><span class="na">flatMapMany</span><span class="o">(</span><span class="nl">Flux:</span><span class="o">:</span><span class="n">fromIterable</span><span class="o">);</span>

<span class="c1">// Mono를 반복하는 Flux</span>
<span class="nc">Flux</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">repeatedFlux</span> <span class="o">=</span> <span class="n">mono</span><span class="o">.</span><span class="na">repeat</span><span class="o">(</span><span class="mi">3</span><span class="o">);</span> <span class="c1">// 3번 반복</span>
</code></pre></div></div> <h2 id="백프레셔-backpressure-처리"> <a href="#백프레셔-backpressure-처리" class="anchor-heading" aria-labelledby="백프레셔-backpressure-처리"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 백프레셔 (Backpressure) 처리 </h2> <h3 id="1-백프레셔-전략"> <a href="#1-백프레셔-전략" class="anchor-heading" aria-labelledby="1-백프레셔-전략"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 1. 백프레셔 전략 </h3><pre><code class="language-mermaid">graph TB
    FastPublisher[빠른 Publisher] --&gt; SlowSubscriber[느린 Subscriber]

    subgraph "Backpressure Strategies"
        Buffer[onBackpressureBuffer&lt;br/&gt;버퍼링]
        Drop[onBackpressureDrop&lt;br/&gt;드롭]
        Error[onBackpressureError&lt;br/&gt;에러]
        Latest[onBackpressureLatest&lt;br/&gt;최신만 유지]
    end

    FastPublisher --&gt; Buffer
    FastPublisher --&gt; Drop
    FastPublisher --&gt; Error
    FastPublisher --&gt; Latest
</code></pre><h3 id="2-백프레셔-처리-예제"> <a href="#2-백프레셔-처리-예제" class="anchor-heading" aria-labelledby="2-백프레셔-처리-예제"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 2. 백프레셔 처리 예제 </h3> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Service</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">BackpressureService</span> <span class="o">{</span>

    <span class="c1">// 버퍼링 전략</span>
    <span class="kd">public</span> <span class="nc">Flux</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="nf">bufferStrategy</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="nc">Flux</span><span class="o">.</span><span class="na">interval</span><span class="o">(</span><span class="nc">Duration</span><span class="o">.</span><span class="na">ofMillis</span><span class="o">(</span><span class="mi">10</span><span class="o">))</span>
            <span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="n">i</span> <span class="o">-&gt;</span> <span class="s">"Item-"</span> <span class="o">+</span> <span class="n">i</span><span class="o">)</span>
            <span class="o">.</span><span class="na">onBackpressureBuffer</span><span class="o">(</span><span class="mi">1000</span><span class="o">)</span> <span class="c1">// 최대 1000개 버퍼</span>
            <span class="o">.</span><span class="na">doOnNext</span><span class="o">(</span><span class="n">item</span> <span class="o">-&gt;</span> <span class="n">log</span><span class="o">.</span><span class="na">debug</span><span class="o">(</span><span class="s">"Processing: {}"</span><span class="o">,</span> <span class="n">item</span><span class="o">));</span>
    <span class="o">}</span>

    <span class="c1">// 드롭 전략</span>
    <span class="kd">public</span> <span class="nc">Flux</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="nf">dropStrategy</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="nc">Flux</span><span class="o">.</span><span class="na">interval</span><span class="o">(</span><span class="nc">Duration</span><span class="o">.</span><span class="na">ofMillis</span><span class="o">(</span><span class="mi">10</span><span class="o">))</span>
            <span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="n">i</span> <span class="o">-&gt;</span> <span class="s">"Item-"</span> <span class="o">+</span> <span class="n">i</span><span class="o">)</span>
            <span class="o">.</span><span class="na">onBackpressureDrop</span><span class="o">(</span><span class="n">item</span> <span class="o">-&gt;</span>
                <span class="n">log</span><span class="o">.</span><span class="na">warn</span><span class="o">(</span><span class="s">"Dropped item: {}"</span><span class="o">,</span> <span class="n">item</span><span class="o">))</span>
            <span class="o">.</span><span class="na">doOnNext</span><span class="o">(</span><span class="n">item</span> <span class="o">-&gt;</span> <span class="n">log</span><span class="o">.</span><span class="na">debug</span><span class="o">(</span><span class="s">"Processing: {}"</span><span class="o">,</span> <span class="n">item</span><span class="o">));</span>
    <span class="o">}</span>

    <span class="c1">// 에러 전략</span>
    <span class="kd">public</span> <span class="nc">Flux</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="nf">errorStrategy</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="nc">Flux</span><span class="o">.</span><span class="na">interval</span><span class="o">(</span><span class="nc">Duration</span><span class="o">.</span><span class="na">ofMillis</span><span class="o">(</span><span class="mi">10</span><span class="o">))</span>
            <span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="n">i</span> <span class="o">-&gt;</span> <span class="s">"Item-"</span> <span class="o">+</span> <span class="n">i</span><span class="o">)</span>
            <span class="o">.</span><span class="na">onBackpressureError</span><span class="o">()</span>
            <span class="o">.</span><span class="na">doOnNext</span><span class="o">(</span><span class="n">item</span> <span class="o">-&gt;</span> <span class="n">log</span><span class="o">.</span><span class="na">debug</span><span class="o">(</span><span class="s">"Processing: {}"</span><span class="o">,</span> <span class="n">item</span><span class="o">))</span>
            <span class="o">.</span><span class="na">onErrorReturn</span><span class="o">(</span><span class="s">"Error occurred due to backpressure"</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="c1">// 최신만 유지 전략</span>
    <span class="kd">public</span> <span class="nc">Flux</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="nf">latestStrategy</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="nc">Flux</span><span class="o">.</span><span class="na">interval</span><span class="o">(</span><span class="nc">Duration</span><span class="o">.</span><span class="na">ofMillis</span><span class="o">(</span><span class="mi">10</span><span class="o">))</span>
            <span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="n">i</span> <span class="o">-&gt;</span> <span class="s">"Item-"</span> <span class="o">+</span> <span class="n">i</span><span class="o">)</span>
            <span class="o">.</span><span class="na">onBackpressureLatest</span><span class="o">()</span>
            <span class="o">.</span><span class="na">doOnNext</span><span class="o">(</span><span class="n">item</span> <span class="o">-&gt;</span> <span class="n">log</span><span class="o">.</span><span class="na">debug</span><span class="o">(</span><span class="s">"Processing: {}"</span><span class="o">,</span> <span class="n">item</span><span class="o">));</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div> <h2 id="실제-사용-사례"> <a href="#실제-사용-사례" class="anchor-heading" aria-labelledby="실제-사용-사례"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 실제 사용 사례 </h2> <h3 id="1-데이터베이스-조회"> <a href="#1-데이터베이스-조회" class="anchor-heading" aria-labelledby="1-데이터베이스-조회"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 1. 데이터베이스 조회 </h3> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Service</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ReactiveUserService</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">ReactiveUserRepository</span> <span class="n">userRepository</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">ReactiveUserService</span><span class="o">(</span><span class="nc">ReactiveUserRepository</span> <span class="n">userRepository</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">userRepository</span> <span class="o">=</span> <span class="n">userRepository</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="c1">// 단일 사용자 조회 (Mono)</span>
    <span class="kd">public</span> <span class="nc">Mono</span><span class="o">&lt;</span><span class="nc">User</span><span class="o">&gt;</span> <span class="nf">findById</span><span class="o">(</span><span class="nc">String</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">userRepository</span><span class="o">.</span><span class="na">findById</span><span class="o">(</span><span class="n">id</span><span class="o">)</span>
            <span class="o">.</span><span class="na">doOnNext</span><span class="o">(</span><span class="n">user</span> <span class="o">-&gt;</span> <span class="n">log</span><span class="o">.</span><span class="na">debug</span><span class="o">(</span><span class="s">"Found user: {}"</span><span class="o">,</span> <span class="n">user</span><span class="o">.</span><span class="na">getEmail</span><span class="o">()))</span>
            <span class="o">.</span><span class="na">doOnError</span><span class="o">(</span><span class="n">error</span> <span class="o">-&gt;</span> <span class="n">log</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="s">"Error finding user: {}"</span><span class="o">,</span> <span class="n">error</span><span class="o">.</span><span class="na">getMessage</span><span class="o">()));</span>
    <span class="o">}</span>

    <span class="c1">// 모든 사용자 조회 (Flux)</span>
    <span class="kd">public</span> <span class="nc">Flux</span><span class="o">&lt;</span><span class="nc">User</span><span class="o">&gt;</span> <span class="nf">findAll</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">userRepository</span><span class="o">.</span><span class="na">findAll</span><span class="o">()</span>
            <span class="o">.</span><span class="na">filter</span><span class="o">(</span><span class="nl">User:</span><span class="o">:</span><span class="n">isActive</span><span class="o">)</span>
            <span class="o">.</span><span class="na">doOnNext</span><span class="o">(</span><span class="n">user</span> <span class="o">-&gt;</span> <span class="n">log</span><span class="o">.</span><span class="na">debug</span><span class="o">(</span><span class="s">"Processing user: {}"</span><span class="o">,</span> <span class="n">user</span><span class="o">.</span><span class="na">getName</span><span class="o">()));</span>
    <span class="o">}</span>

    <span class="c1">// 사용자 검색 (Flux)</span>
    <span class="kd">public</span> <span class="nc">Flux</span><span class="o">&lt;</span><span class="nc">User</span><span class="o">&gt;</span> <span class="nf">findByEmailContaining</span><span class="o">(</span><span class="nc">String</span> <span class="n">email</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">userRepository</span><span class="o">.</span><span class="na">findByEmailContainingIgnoreCase</span><span class="o">(</span><span class="n">email</span><span class="o">)</span>
            <span class="o">.</span><span class="na">take</span><span class="o">(</span><span class="mi">10</span><span class="o">)</span> <span class="c1">// 최대 10개만 반환</span>
            <span class="o">.</span><span class="na">doOnNext</span><span class="o">(</span><span class="n">user</span> <span class="o">-&gt;</span> <span class="n">log</span><span class="o">.</span><span class="na">debug</span><span class="o">(</span><span class="s">"Found matching user: {}"</span><span class="o">,</span> <span class="n">user</span><span class="o">.</span><span class="na">getEmail</span><span class="o">()));</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div> <h3 id="2-외부-api-호출"> <a href="#2-외부-api-호출" class="anchor-heading" aria-labelledby="2-외부-api-호출"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 2. 외부 API 호출 </h3> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Service</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ExternalApiService</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">WebClient</span> <span class="n">webClient</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">ExternalApiService</span><span class="o">(</span><span class="nc">WebClient</span> <span class="n">webClient</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">webClient</span> <span class="o">=</span> <span class="n">webClient</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="c1">// 단일 API 호출 (Mono)</span>
    <span class="kd">public</span> <span class="nc">Mono</span><span class="o">&lt;</span><span class="nc">User</span><span class="o">&gt;</span> <span class="nf">getUserFromApi</span><span class="o">(</span><span class="nc">String</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">webClient</span><span class="o">.</span><span class="na">get</span><span class="o">()</span>
            <span class="o">.</span><span class="na">uri</span><span class="o">(</span><span class="s">"/users/{id}"</span><span class="o">,</span> <span class="n">id</span><span class="o">)</span>
            <span class="o">.</span><span class="na">retrieve</span><span class="o">()</span>
            <span class="o">.</span><span class="na">bodyToMono</span><span class="o">(</span><span class="nc">User</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
            <span class="o">.</span><span class="na">timeout</span><span class="o">(</span><span class="nc">Duration</span><span class="o">.</span><span class="na">ofSeconds</span><span class="o">(</span><span class="mi">5</span><span class="o">))</span>
            <span class="o">.</span><span class="na">onErrorReturn</span><span class="o">(</span><span class="k">new</span> <span class="nc">User</span><span class="o">(</span><span class="n">id</span><span class="o">,</span> <span class="s">"Unknown"</span><span class="o">));</span>
    <span class="o">}</span>

    <span class="c1">// 여러 API 호출 (Flux)</span>
    <span class="kd">public</span> <span class="nc">Flux</span><span class="o">&lt;</span><span class="nc">User</span><span class="o">&gt;</span> <span class="nf">getUsersFromApi</span><span class="o">(</span><span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">ids</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="nc">Flux</span><span class="o">.</span><span class="na">fromIterable</span><span class="o">(</span><span class="n">ids</span><span class="o">)</span>
            <span class="o">.</span><span class="na">flatMap</span><span class="o">(</span><span class="k">this</span><span class="o">::</span><span class="n">getUserFromApi</span><span class="o">)</span>
            <span class="o">.</span><span class="na">doOnNext</span><span class="o">(</span><span class="n">user</span> <span class="o">-&gt;</span> <span class="n">log</span><span class="o">.</span><span class="na">debug</span><span class="o">(</span><span class="s">"Retrieved user: {}"</span><span class="o">,</span> <span class="n">user</span><span class="o">.</span><span class="na">getName</span><span class="o">()));</span>
    <span class="o">}</span>

    <span class="c1">// 병렬 API 호출</span>
    <span class="kd">public</span> <span class="nc">Flux</span><span class="o">&lt;</span><span class="nc">User</span><span class="o">&gt;</span> <span class="nf">getUsersParallel</span><span class="o">(</span><span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">ids</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="nc">Flux</span><span class="o">.</span><span class="na">fromIterable</span><span class="o">(</span><span class="n">ids</span><span class="o">)</span>
            <span class="o">.</span><span class="na">flatMap</span><span class="o">(</span><span class="k">this</span><span class="o">::</span><span class="n">getUserFromApi</span><span class="o">,</span> <span class="mi">5</span><span class="o">)</span> <span class="c1">// 최대 5개 병렬 처리</span>
            <span class="o">.</span><span class="na">doOnNext</span><span class="o">(</span><span class="n">user</span> <span class="o">-&gt;</span> <span class="n">log</span><span class="o">.</span><span class="na">debug</span><span class="o">(</span><span class="s">"Retrieved user: {}"</span><span class="o">,</span> <span class="n">user</span><span class="o">.</span><span class="na">getName</span><span class="o">()));</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div> <h3 id="3-파일-처리"> <a href="#3-파일-처리" class="anchor-heading" aria-labelledby="3-파일-처리"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 3. 파일 처리 </h3> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Service</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">FileProcessingService</span> <span class="o">{</span>

    <span class="c1">// 파일 읽기 (Flux)</span>
    <span class="kd">public</span> <span class="nc">Flux</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="nf">readFileLines</span><span class="o">(</span><span class="nc">Path</span> <span class="n">filePath</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="nc">Flux</span><span class="o">.</span><span class="na">using</span><span class="o">(</span>
            <span class="o">()</span> <span class="o">-&gt;</span> <span class="nc">Files</span><span class="o">.</span><span class="na">lines</span><span class="o">(</span><span class="n">filePath</span><span class="o">),</span>
            <span class="nl">Flux:</span><span class="o">:</span><span class="n">fromStream</span><span class="o">,</span>
            <span class="nl">BaseStream:</span><span class="o">:</span><span class="n">close</span>
        <span class="o">).</span><span class="na">doOnNext</span><span class="o">(</span><span class="n">line</span> <span class="o">-&gt;</span> <span class="n">log</span><span class="o">.</span><span class="na">debug</span><span class="o">(</span><span class="s">"Processing line: {}"</span><span class="o">,</span> <span class="n">line</span><span class="o">));</span>
    <span class="o">}</span>

    <span class="c1">// 파일 쓰기 (Mono)</span>
    <span class="kd">public</span> <span class="nc">Mono</span><span class="o">&lt;</span><span class="nc">Void</span><span class="o">&gt;</span> <span class="nf">writeToFile</span><span class="o">(</span><span class="nc">Flux</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">lines</span><span class="o">,</span> <span class="nc">Path</span> <span class="n">filePath</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">lines</span>
            <span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="n">line</span> <span class="o">-&gt;</span> <span class="n">line</span> <span class="o">+</span> <span class="s">"\n"</span><span class="o">)</span>
            <span class="o">.</span><span class="na">reduce</span><span class="o">(</span><span class="k">new</span> <span class="nc">StringBuilder</span><span class="o">(),</span> <span class="nl">StringBuilder:</span><span class="o">:</span><span class="n">append</span><span class="o">)</span>
            <span class="o">.</span><span class="na">flatMap</span><span class="o">(</span><span class="n">content</span> <span class="o">-&gt;</span> <span class="o">{</span>
                <span class="k">try</span> <span class="o">{</span>
                    <span class="nc">Files</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">filePath</span><span class="o">,</span> <span class="n">content</span><span class="o">.</span><span class="na">toString</span><span class="o">().</span><span class="na">getBytes</span><span class="o">());</span>
                    <span class="k">return</span> <span class="nc">Mono</span><span class="o">.</span><span class="na">empty</span><span class="o">();</span>
                <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                    <span class="k">return</span> <span class="nc">Mono</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
                <span class="o">}</span>
            <span class="o">});</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div> <h2 id="디버깅과-모니터링"> <a href="#디버깅과-모니터링" class="anchor-heading" aria-labelledby="디버깅과-모니터링"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 디버깅과 모니터링 </h2> <h3 id="1-로깅"> <a href="#1-로깅" class="anchor-heading" aria-labelledby="1-로깅"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 1. 로깅 </h3> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Mono 로깅</span>
<span class="nc">Mono</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">loggedMono</span> <span class="o">=</span> <span class="nc">Mono</span><span class="o">.</span><span class="na">just</span><span class="o">(</span><span class="s">"Hello"</span><span class="o">)</span>
    <span class="o">.</span><span class="na">doOnSubscribe</span><span class="o">(</span><span class="n">subscription</span> <span class="o">-&gt;</span> <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"Mono subscribed"</span><span class="o">))</span>
    <span class="o">.</span><span class="na">doOnNext</span><span class="o">(</span><span class="n">item</span> <span class="o">-&gt;</span> <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"Mono emitted: {}"</span><span class="o">,</span> <span class="n">item</span><span class="o">))</span>
    <span class="o">.</span><span class="na">doOnSuccess</span><span class="o">(</span><span class="n">result</span> <span class="o">-&gt;</span> <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"Mono completed successfully"</span><span class="o">))</span>
    <span class="o">.</span><span class="na">doOnError</span><span class="o">(</span><span class="n">error</span> <span class="o">-&gt;</span> <span class="n">log</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="s">"Mono failed: {}"</span><span class="o">,</span> <span class="n">error</span><span class="o">.</span><span class="na">getMessage</span><span class="o">()))</span>
    <span class="o">.</span><span class="na">doFinally</span><span class="o">(</span><span class="n">signalType</span> <span class="o">-&gt;</span> <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"Mono finally: {}"</span><span class="o">,</span> <span class="n">signalType</span><span class="o">));</span>

<span class="c1">// Flux 로깅</span>
<span class="nc">Flux</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">loggedFlux</span> <span class="o">=</span> <span class="nc">Flux</span><span class="o">.</span><span class="na">just</span><span class="o">(</span><span class="s">"A"</span><span class="o">,</span> <span class="s">"B"</span><span class="o">,</span> <span class="s">"C"</span><span class="o">)</span>
    <span class="o">.</span><span class="na">doOnSubscribe</span><span class="o">(</span><span class="n">subscription</span> <span class="o">-&gt;</span> <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"Flux subscribed"</span><span class="o">))</span>
    <span class="o">.</span><span class="na">doOnNext</span><span class="o">(</span><span class="n">item</span> <span class="o">-&gt;</span> <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"Flux emitted: {}"</span><span class="o">,</span> <span class="n">item</span><span class="o">))</span>
    <span class="o">.</span><span class="na">doOnComplete</span><span class="o">(()</span> <span class="o">-&gt;</span> <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"Flux completed"</span><span class="o">))</span>
    <span class="o">.</span><span class="na">doOnError</span><span class="o">(</span><span class="n">error</span> <span class="o">-&gt;</span> <span class="n">log</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="s">"Flux failed: {}"</span><span class="o">,</span> <span class="n">error</span><span class="o">.</span><span class="na">getMessage</span><span class="o">()))</span>
    <span class="o">.</span><span class="na">doFinally</span><span class="o">(</span><span class="n">signalType</span> <span class="o">-&gt;</span> <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">"Flux finally: {}"</span><span class="o">,</span> <span class="n">signalType</span><span class="o">));</span>
</code></pre></div></div> <h3 id="2-메트릭-수집"> <a href="#2-메트릭-수집" class="anchor-heading" aria-labelledby="2-메트릭-수집"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 2. 메트릭 수집 </h3> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Component</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ReactiveMetrics</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">MeterRegistry</span> <span class="n">meterRegistry</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">ReactiveMetrics</span><span class="o">(</span><span class="nc">MeterRegistry</span> <span class="n">meterRegistry</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">meterRegistry</span> <span class="o">=</span> <span class="n">meterRegistry</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="c1">// Mono 메트릭</span>
    <span class="kd">public</span> <span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="nc">Mono</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="nf">withMetrics</span><span class="o">(</span><span class="nc">Mono</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="n">mono</span><span class="o">,</span> <span class="nc">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">Timer</span><span class="o">.</span><span class="na">Sample</span> <span class="n">sample</span> <span class="o">=</span> <span class="nc">Timer</span><span class="o">.</span><span class="na">start</span><span class="o">(</span><span class="n">meterRegistry</span><span class="o">);</span>

        <span class="k">return</span> <span class="n">mono</span>
            <span class="o">.</span><span class="na">doOnSuccess</span><span class="o">(</span><span class="n">result</span> <span class="o">-&gt;</span> <span class="o">{</span>
                <span class="n">sample</span><span class="o">.</span><span class="na">stop</span><span class="o">(</span><span class="nc">Timer</span><span class="o">.</span><span class="na">builder</span><span class="o">(</span><span class="s">"mono.duration"</span><span class="o">)</span>
                    <span class="o">.</span><span class="na">tag</span><span class="o">(</span><span class="s">"name"</span><span class="o">,</span> <span class="n">name</span><span class="o">)</span>
                    <span class="o">.</span><span class="na">tag</span><span class="o">(</span><span class="s">"status"</span><span class="o">,</span> <span class="s">"success"</span><span class="o">)</span>
                    <span class="o">.</span><span class="na">register</span><span class="o">(</span><span class="n">meterRegistry</span><span class="o">));</span>
            <span class="o">})</span>
            <span class="o">.</span><span class="na">doOnError</span><span class="o">(</span><span class="n">error</span> <span class="o">-&gt;</span> <span class="o">{</span>
                <span class="n">sample</span><span class="o">.</span><span class="na">stop</span><span class="o">(</span><span class="nc">Timer</span><span class="o">.</span><span class="na">builder</span><span class="o">(</span><span class="s">"mono.duration"</span><span class="o">)</span>
                    <span class="o">.</span><span class="na">tag</span><span class="o">(</span><span class="s">"name"</span><span class="o">,</span> <span class="n">name</span><span class="o">)</span>
                    <span class="o">.</span><span class="na">tag</span><span class="o">(</span><span class="s">"status"</span><span class="o">,</span> <span class="s">"error"</span><span class="o">)</span>
                    <span class="o">.</span><span class="na">register</span><span class="o">(</span><span class="n">meterRegistry</span><span class="o">));</span>
            <span class="o">});</span>
    <span class="o">}</span>

    <span class="c1">// Flux 메트릭</span>
    <span class="kd">public</span> <span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="nc">Flux</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="nf">withMetrics</span><span class="o">(</span><span class="nc">Flux</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="n">flux</span><span class="o">,</span> <span class="nc">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">Timer</span><span class="o">.</span><span class="na">Sample</span> <span class="n">sample</span> <span class="o">=</span> <span class="nc">Timer</span><span class="o">.</span><span class="na">start</span><span class="o">(</span><span class="n">meterRegistry</span><span class="o">);</span>
        <span class="nc">AtomicLong</span> <span class="n">count</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">AtomicLong</span><span class="o">();</span>

        <span class="k">return</span> <span class="n">flux</span>
            <span class="o">.</span><span class="na">doOnNext</span><span class="o">(</span><span class="n">item</span> <span class="o">-&gt;</span> <span class="n">count</span><span class="o">.</span><span class="na">incrementAndGet</span><span class="o">())</span>
            <span class="o">.</span><span class="na">doOnComplete</span><span class="o">(()</span> <span class="o">-&gt;</span> <span class="o">{</span>
                <span class="n">sample</span><span class="o">.</span><span class="na">stop</span><span class="o">(</span><span class="nc">Timer</span><span class="o">.</span><span class="na">builder</span><span class="o">(</span><span class="s">"flux.duration"</span><span class="o">)</span>
                    <span class="o">.</span><span class="na">tag</span><span class="o">(</span><span class="s">"name"</span><span class="o">,</span> <span class="n">name</span><span class="o">)</span>
                    <span class="o">.</span><span class="na">tag</span><span class="o">(</span><span class="s">"status"</span><span class="o">,</span> <span class="s">"success"</span><span class="o">)</span>
                    <span class="o">.</span><span class="na">register</span><span class="o">(</span><span class="n">meterRegistry</span><span class="o">));</span>

                <span class="n">meterRegistry</span><span class="o">.</span><span class="na">counter</span><span class="o">(</span><span class="s">"flux.items"</span><span class="o">,</span> <span class="s">"name"</span><span class="o">,</span> <span class="n">name</span><span class="o">)</span>
                    <span class="o">.</span><span class="na">increment</span><span class="o">(</span><span class="n">count</span><span class="o">.</span><span class="na">get</span><span class="o">());</span>
            <span class="o">})</span>
            <span class="o">.</span><span class="na">doOnError</span><span class="o">(</span><span class="n">error</span> <span class="o">-&gt;</span> <span class="o">{</span>
                <span class="n">sample</span><span class="o">.</span><span class="na">stop</span><span class="o">(</span><span class="nc">Timer</span><span class="o">.</span><span class="na">builder</span><span class="o">(</span><span class="s">"flux.duration"</span><span class="o">)</span>
                    <span class="o">.</span><span class="na">tag</span><span class="o">(</span><span class="s">"name"</span><span class="o">,</span> <span class="n">name</span><span class="o">)</span>
                    <span class="o">.</span><span class="na">tag</span><span class="o">(</span><span class="s">"status"</span><span class="o">,</span> <span class="s">"error"</span><span class="o">)</span>
                    <span class="o">.</span><span class="na">register</span><span class="o">(</span><span class="n">meterRegistry</span><span class="o">));</span>
            <span class="o">});</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div> <h2 id="결론"> <a href="#결론" class="anchor-heading" aria-labelledby="결론"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 결론 </h2> <p>Mono와 Flux는 Spring WebFlux의 핵심 구성 요소로, 비동기 데이터 스트림을 효율적으로 처리할 수 있게 해줍니다.</p> <h3 id="주요-포인트"> <a href="#주요-포인트" class="anchor-heading" aria-labelledby="주요-포인트"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 주요 포인트: </h3> <ol> <li><strong>Mono</strong>: 0개 또는 1개의 요소를 처리하는 단일 결과 스트림</li> <li><strong>Flux</strong>: 0개 이상의 요소를 처리하는 다중 데이터 스트림</li> <li><strong>백프레셔</strong>: 빠른 생산자와 느린 소비자 간의 흐름 제어</li> <li><strong>에러 처리</strong>: 다양한 에러 처리 전략 제공</li> <li><strong>변환과 조합</strong>: 풍부한 연산자를 통한 데이터 처리</li> <li><strong>모니터링</strong>: 로깅과 메트릭을 통한 관찰성</li> </ol> <h3 id="학습-로드맵"> <a href="#학습-로드맵" class="anchor-heading" aria-labelledby="학습-로드맵"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> 학습 로드맵: </h3> <ol> <li><strong>기초</strong>: Mono와 Flux의 기본 생성과 구독</li> <li><strong>중급</strong>: 변환, 필터링, 결합 연산자 활용</li> <li><strong>고급</strong>: 백프레셔 처리, 에러 처리, 성능 최적화</li> <li><strong>실전</strong>: 실제 프로젝트에서의 활용과 모니터링</li> </ol> <p>Mono와 Flux를 마스터하면 Spring WebFlux의 강력한 비동기 프로그래밍 능력을 활용할 수 있으며, 고성능 웹 애플리케이션을 구축할 수 있습니다.</p> </main> </div> </div> <div class="search-overlay"></div> </div> <script type="module"> import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.esm.min.mjs'; var config = {} ; mermaid.initialize(config); mermaid.run({ querySelector: '.language-mermaid', }); </script> </body> </html>
